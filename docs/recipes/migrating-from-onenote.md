# OneNoteからの移行

このガイドは、PowerShell [スクリプト](https://github.com/nixsee/ConvertOneNote2MarkDown) のリポジトリにある説明とほとんど重複しています。

## 概要

パワーシェル・スクリプト'ConvertOneNote2MarkDown-v2.ps1'は、ワークステーション上のOneNoteオブジェクト・モデルを利用して、すべてのOneNoteページをWord文書に変換し、PanDocを利用してWord文書をMarkdown (.md) 形式に変換します。また

* ノートブックとセクションのためのフォルダ構造を作成します。
* ノートブック、セクショングループ、および1階層のセクショングループレベルにあるセクション内のページを処理します。
* 各ノートブックの中央の'/media'フォルダにすべての画像を配置するか、階層内の各フォルダに別の'/media'フォルダを配置するかを選択できます。
* 結果として得られる.mdファイル内の画像参照を修正し、マークダウンドキュメント内の画像ファイルへの相対参照を生成します。
* 各ファイルにタイトル、説明、および日付のヘッダーが追加されます。
* その他 (詳細はリポジトリを参照) !

## 使用方法

1. OneNoteアプリケーションを起動します。現在[OneNote](https://getonetastic.com/download)にロードされているすべてのノートブックが変換されます。
2. [Onetastic](https://getonetastic.com/download)と添付のマクロをインストールすることをお勧めします。これにより、ノートブック内の折りたたまれた段落が自動的に展開されます。そうしないと、それらはエクスポートされません。
    * マクロをインストールするには、Onetasticツールバー内の新しいマクロボタンをクリックし、ファイル -> インポートを選択して、リリースに含まれる.xmlマクロを選択します。
    * 開いている各ノートブックに対してマクロを実行します。
3. 次のセクションでは、VS Codeとその組み込みのPowerShellターミナルを使用することを強くお勧めします。これにより、スクリプトの編集と実行、および.md出力の結果の確認をすべて1つのウィンドウで行うことができます。
4. どちらを選択するにしても、次のことを行う必要があります。
   1. スクリプトをコンピュータにクローンします (gitに不慣れな場合は、[こちら](https://git-scm.com/book/en/v2/Git-Basics-Getting-a-Git-Repository)を参照してください) 。
   2. クローンしたら、リポジトリフォルダに移動します。VS Codeでは、ファイル -> ワークスペースにフォルダを追加を使用し、左サイドバーでフォルダを右クリックして[統合ターミナルで開く](../../assets/images/migrating-one-note.png)をクリックします。
   3. スクリプトを実行するには、次のコマンドを実行します。
```.\ConvertOnenote2Markdown-v2```
    * エラーが発生した場合は、セキュリティをバイパスするために次の行を試してください:
     ```Set-ExecutionPolicy Bypass -Scope Process```
    * それでも問題が解決しない場合は、OnenoteとPowershellを管理者として実行してみてください。
5. マークダウンフォルダ構造を保存するパスを尋ねられます。空のフォルダを使用してください。VS Codeを使用している場合、ファイルパスを貼り付けることができないかもしれません - 点滅するカーソルを右クリックすると、クリップボードから貼り付けられます。**注意: **宛先には絶対パスを使用してください。
6. 望ましいオプションを選択するために、プロンプトを注意深く読んでください。Onenoteでページをアクティブに編集していない場合は、中間のwordドキュメントを削除しないことを強くお勧めします。これらは自分のフォルダに保存され、80%以上の時間を節約できます。その後、異なるパラメータでスクリプトをすばやく再実行して、好みに合ったものを見つけることができます。
7. 処理が完了するまで待ちます。
8. いつでもプロセスを停止するには、Ctrl+Cを押します。
9. 必要に応じて、いくつかの.mdファイルを完成前に検査することができます。結果に満足できない場合は、プロセスを停止し、.mdを削除して、異なるパラメータで再実行してください。
10. この時点で、新しいディレクトリをFoamにロードする準備が整いました!


